{
  if (mScroller.computeScrollOffset()) {
    int startX=getScrollX();
    int startY=getScrollY();
    int endX=constrainX(mScroller.getCurrX());
    int endY=constrainY(mScroller.getCurrY());
    if (startX != endX || startY != endY) {
      scrollTo(endX,endY);
      if (mIsFlinging) {
        broadcastFlingUpdate(endX,endY);
      }
 else       if (mIsSliding) {
        broadcastProgrammaticPanUpdate(endX,endY);
        if (mShouldScaleWhileSliding) {
          float changeX=mScroller.getFinalX() - mScroller.getStartX();
          float travelledX=mScroller.getCurrX() - mScroller.getStartX();
          float completeX=Math.min(1f,travelledX / changeX);
          float scaleChange=mScaleAtEndOfSlide - mScaleAtStartOfSlide;
          float scaleUpdate=mScaleAtStartOfSlide + (scaleChange * completeX);
          setScale(scaleUpdate);
          Log.d("Scroll","completeX=" + scaleUpdate);
        }
      }
    }
    if (!mScroller.isFinished()) {
      ViewCompat.postInvalidateOnAnimation(this);
    }
  }
}
